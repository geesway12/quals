<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="QualiData"><meta name="theme-color" content="#2196f3"><link rel="apple-touch-icon" href="icon-192.png"><link rel="apple-touch-icon" sizes="192x192" href="icon-192.png"><link rel="apple-touch-icon" sizes="512x512" href="icon-512.png"><link rel="icon" type="image/png" sizes="192x192" href="icon-192.png"><link rel="shortcut icon" href="favicon.ico"><link rel="manifest" href="manifest.json"><title>Screening & Tracker - QualiData</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"><style>body{background:linear-gradient(135deg,#667eea 0,#764ba2 100%);min-height:100vh;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;position:relative}body::before{content:'';position:fixed;top:0;left:0;width:100%;height:100%;background-image:url('assets/collaboration.png');background-size:cover;background-position:center;background-repeat:no-repeat;opacity:.1;z-index:-1}.navbar{background:rgba(255,255,255,.95);backdrop-filter:blur(10px);box-shadow:0 2px 20px rgba(0,0,0,.1);padding-top:1rem;padding-bottom:1rem;min-height:80px}.partner-logos{display:flex;align-items:center;gap:20px;margin-left:auto;margin-right:2rem}.partner-logos img{height:36px;opacity:.8;transition:opacity .3s ease}.partner-logos img:hover{opacity:1}@media (max-width:768px){.partner-logos{display:none}}.main-content{background:rgba(255,255,255,.95);backdrop-filter:blur(10px);border-radius:15px;margin:2rem auto;padding:2rem;box-shadow:0 8px 25px rgba(0,0,0,.1);max-width:1200px}.btn-back{background:linear-gradient(135deg,#6c757d,#495057);border:none;color:#fff;padding:.5rem 1rem;border-radius:25px;text-decoration:none;transition:all .3s ease}.btn-back:hover{transform:scale(1.05);color:#fff}.screening-wizard{display:none}.screening-wizard.active{display:block}.step-indicator{display:flex;justify-content:center;margin-bottom:2rem}.step{width:40px;height:40px;border-radius:50%;background:#e9ecef;display:flex;align-items:center;justify-content:center;margin:0 1rem;position:relative;transition:all .3s ease}.step.active{background:#2196f3;color:#fff}.step.completed{background:#4caf50;color:#fff}.step::after{content:'';position:absolute;top:50%;left:100%;width:2rem;height:2px;background:#e9ecef;transform:translateY(-50%)}.step:last-child::after{display:none}.step.completed::after{background:#4caf50}.eligibility-checklist{background:#f8f9fa;border-radius:10px;padding:1.5rem;margin:1rem 0}.criteria-item{background:#fff;border-radius:8px;padding:1rem;margin:.5rem 0;border-left:4px solid #e9ecef;transition:all .3s ease}.criteria-item.valid{border-left-color:#4caf50;background:#f1f8e9}.criteria-item.invalid{border-left-color:#f44336;background:#ffebee}.participant-card{background:#fff;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.1);margin:1rem 0;overflow:hidden;transition:all .3s ease}.participant-card:hover{transform:translateY(-2px);box-shadow:0 4px 20px rgba(0,0,0,.15)}.participant-header{padding:1rem;border-bottom:1px solid #e9ecef}.participant-body{padding:1rem}.status-badge{font-size:.8rem;padding:.25rem .5rem;border-radius:15px}.type-badge{font-size:.75rem;padding:.2rem .6rem;border-radius:12px}@media (max-width:768px){.main-content{margin:1rem;padding:1rem}.step-indicator{flex-wrap:wrap}.step{margin:.25rem}}</style></head><body><nav class="navbar navbar-expand-lg fixed-top"><div class="container"><a href="index.html" class="btn-back me-3"><i class="bi bi-arrow-left me-2"></i>Back </a><span class="navbar-brand fw-bold text-primary mb-0"><i class="bi bi-people me-2"></i>Screening & Tracker</span><div class="partner-logos"><img src="assets/uhas.jpg" alt="UHAS" title="University of Health and Allied Sciences"> <img src="assets/hpi.png" alt="HPI" title="Hasso Plattner Institute"> <img src="assets/ghs.jpg" alt="GHS" title="Ghana Health Service"> <img src="assets/cpmr.png" alt="CPMR" title="Centre for Plant Medicine Research"></div></div></nav><div class="main-content" style="margin-top:120px"><div class="container-fluid"><div class="row mb-4"><div class="col-md-6"><button class="btn btn-primary btn-lg w-100" onclick="showScreeningWizard()"><i class="bi bi-person-plus me-2"></i>New Participant Screening</button></div><div class="col-md-6"><button class="btn btn-outline-primary btn-lg w-100" onclick="showParticipantList()"><i class="bi bi-list me-2"></i>View All Participants</button></div></div><div id="screeningWizardContainer" class="screening-wizard"><div class="card"><div class="card-header bg-primary text-white"><h5 class="mb-0"><i class="bi bi-person-check me-2"></i>Participant Screening Wizard</h5></div><div class="card-body"><div class="step-indicator"><div class="step active" id="step1">1</div><div class="step" id="step2">2</div><div class="step" id="step3">3</div><div class="step" id="step4">4</div></div><div id="wizardStep1" class="wizard-step active"><h4 class="text-center mb-4">Select Participant Type</h4><div class="row"><div class="col-md-6 col-lg-3 mb-3"><div class="card h-100 participant-type-card" onclick='selectParticipantType("Patient")'><div class="card-body text-center"><i class="bi bi-heart-pulse display-4 text-danger mb-3"></i><h5>Patient</h5><p class="text-muted">Individuals with hypertension</p></div></div></div><div class="col-md-6 col-lg-3 mb-3"><div class="card h-100 participant-type-card" onclick='selectParticipantType("Clinician")'><div class="card-body text-center"><i class="bi bi-hospital display-4 text-primary mb-3"></i><h5>Clinician</h5><p class="text-muted">Healthcare professionals</p></div></div></div><div class="col-md-6 col-lg-3 mb-3"><div class="card h-100 participant-type-card" onclick='selectParticipantType("Herbalist")'><div class="card-body text-center"><i class="bi bi-flower2 display-4 text-success mb-3"></i><h5>Herbalist</h5><p class="text-muted">Traditional healers</p></div></div></div><div class="col-md-6 col-lg-3 mb-3"><div class="card h-100 participant-type-card" onclick='selectParticipantType("Policy Stakeholder")'><div class="card-body text-center"><i class="bi bi-briefcase display-4 text-warning mb-3"></i><h5>Policy Stakeholder</h5><p class="text-muted">Policy makers & regulators</p></div></div></div><div class="col-md-6 col-lg-3 mb-3"><div class="card h-100 participant-type-card" onclick='selectParticipantType("Caregiver")'><div class="card-body text-center"><i class="bi bi-person-heart display-4 text-info mb-3"></i><h5>Caregiver</h5><p class="text-muted">Support for patients</p></div></div></div></div></div><div id="wizardStep2" class="wizard-step" style="display:none"><h4 class="text-center mb-4">Basic Information</h4><div class="row"><div class="col-md-6 mb-3"><label for="participantAgeRange" class="form-label">Age Range *</label> <select class="form-select" id="participantAgeRange" required><option value="">Select age range</option><option value="18-24">18-24</option><option value="25-34">25-34</option><option value="35-44">35-44</option><option value="45-54">45-54</option><option value="55-64">55-64</option><option value="65+">65+</option></select><div class="form-text">Select age range (18+ only)</div></div><div class="col-md-6 mb-3"><label for="participantGender" class="form-label">Gender *</label> <select class="form-select" id="participantGender" required><option value="">Select gender</option><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option></select></div><div class="col-md-6 mb-3"><label class="form-label">District</label> <input type="text" class="form-control" id="participantDistrict" readonly="readonly"></div><div class="col-md-6 mb-3"><label class="form-label">Hospital/Health Facility</label> <input type="text" class="form-control" id="participantHospital" readonly="readonly"></div></div><div class="text-end"><button class="btn btn-outline-secondary me-2" onclick="previousStep()">Previous</button> <button class="btn btn-primary" onclick="nextStep()">Next</button></div></div><div id="wizardStep3" class="wizard-step" style="display:none"><h4 class="text-center mb-4">Eligibility Assessment</h4><div id="eligibilityChecklist"></div><div class="text-end"><button class="btn btn-outline-secondary me-2" onclick="previousStep()">Previous</button> <button class="btn btn-primary" onclick="nextStep()">Next</button></div></div><div id="wizardStep4" class="wizard-step" style="display:none"><h4 class="text-center mb-4">Review & Save</h4><div id="reviewSummary" class="eligibility-checklist"></div><div class="text-end"><button class="btn btn-outline-secondary me-2" onclick="previousStep()">Previous</button> <button class="btn btn-success" onclick="saveParticipant()"><i class="bi bi-check-circle me-2"></i>Save Participant</button></div></div></div></div></div><div id="participantsListContainer"><div class="card"><div class="card-header bg-info text-white d-flex justify-content-between align-items-center"><h5 class="mb-0"><i class="bi bi-people me-2"></i>Participant Database</h5><div><select class="form-select form-select-sm d-inline-block w-auto me-2" id="filterType"><option value="">All Types</option><option value="Patient">Patients</option><option value="Clinician">Clinicians</option><option value="Herbalist">Herbalists</option><option value="Policy Stakeholder">Policy Stakeholders</option><option value="Caregiver">Caregivers</option></select> <select class="form-select form-select-sm d-inline-block w-auto me-2" id="filterStatus"><option value="">All Status</option><option value="eligible">Eligible</option><option value="not-eligible">Not Eligible</option></select> <button class="btn btn-outline-light btn-sm" id="exportCsvBtn" onclick="exportParticipantsToCSV()"><i class="bi bi-download me-1"></i>Export CSV</button></div></div><div class="card-body"><div id="participantsList"><div class="text-center text-muted py-5"><i class="bi bi-people display-1"></i><h5 class="mt-3">No participants yet</h5><p>Start by screening your first participant</p><button class="btn btn-primary" onclick="showScreeningWizard()"><i class="bi bi-person-plus me-2"></i>Add First Participant</button></div></div></div></div></div></div></div><footer class="mt-5 pt-4 border-top text-center" style="background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff"><img src="logo.png" alt="QualiData Logo" style="height:48px;margin-bottom:10px"><div class="mb-2 fw-bold">QualiData Research Platform</div><div id="metaInfo" class="mb-2"></div><div class="mb-2"><span class="fw-semibold">PI:</span> Godsway Sackey &mdash; <a href="mailto:godswaysackey@gmail.com" style="color:#e3f2fd">godswaysackey@gmail.com</a> &mdash; <a href="tel:+233269609634" style="color:#e3f2fd">+233 26 960 9634</a></div><div class="mb-2"><span class="fw-semibold">Supervisor:</span> Prof. Frank Baiden (UHAS) &nbsp;|&nbsp; Dr. Stefan Konigorski (HPI)</div><div class="mt-3 mb-2 small">&copy; 2025 QualiData Research Platform</div></footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script><script>class ScreeningWizard{constructor(){this.currentStep=1,this.participantData={},this.eligibilityCriteria={},this.dataManager=window.parent?.dataManager||this.initDataManager(),this.loadParticipants()}initDataManager(){return{participants:JSON.parse(localStorage.getItem("qualidata_participants")||"[]"),addParticipant:t=>(t.participantId=this.generateParticipantId(t.participantType),t.dateOfContact=(new Date).toISOString(),t.dateAdded=(new Date).toISOString(),t.dateEnrolled=null,t.raInitials=this.getRAInitials(),this.participants=JSON.parse(localStorage.getItem("qualidata_participants")||"[]"),this.participants.push(t),localStorage.setItem("qualidata_participants",JSON.stringify(this.participants)),t.participantId)}}nextStep(){if(2===this.currentStep){const t=document.getElementById("participantAgeRange").value,e=document.getElementById("participantGender").value;if(!t||!e)return void alert("Please fill in all required fields.");const i=JSON.parse(localStorage.getItem("researchAssistantDetails")||"{}");this.participantData.basicInfo={ageRange:t,gender:e,district:i.district||"",hospital:i.hospital||""},document.getElementById("participantDistrict").value=i.district||"",document.getElementById("participantHospital").value=i.hospital||"",this.generateEligibilityChecklist()}3===this.currentStep&&(this.evaluateEligibility(),this.generateReviewSummary()),this.currentStep<4&&this.showStep(this.currentStep+1)}previousStep(){this.currentStep>1&&this.showStep(this.currentStep-1)}generateEligibilityChecklist(){const t=this.getEligibilityCriteria(this.participantData.participantType),e=document.getElementById("eligibilityChecklist");e.innerHTML=`\n          <div class="alert alert-info">\n            <i class="bi bi-info-circle me-2"></i>\n            <strong>Eligibility Assessment for ${this.participantData.participantType}</strong><br>\n            Please verify each criterion with the participant. All criteria marked as required must be met.\n          </div>\n        `,t.forEach(t=>{const i=`\n            <div class="criteria-item" id="criteria_${t.id}">\n              <div class="d-flex justify-content-between align-items-center">\n                <div class="flex-grow-1">\n                  <label class="form-label fw-semibold">${t.text}</label>\n                  ${t.note?`<div class="text-muted small">${t.note}</div>`:""}\n                </div>\n                <div class="btn-group" role="group">\n                  <input type="radio" class="btn-check" name="criteria_${t.id}" id="yes_${t.id}" value="yes">\n                  <label class="btn btn-outline-success" for="yes_${t.id}">\n                    <i class="bi bi-check"></i> Yes\n                  </label>\n                  \n                  <input type="radio" class="btn-check" name="criteria_${t.id}" id="no_${t.id}" value="no">\n                  <label class="btn btn-outline-danger" for="no_${t.id}">\n                    <i class="bi bi-x"></i> No\n                  </label>\n                </div>\n              </div>\n              <div class="mt-2">\n                <textarea class="form-control form-control-sm" placeholder="Comments (optional)" id="comment_${t.id}"></textarea>\n              </div>\n            </div>\n          `;e.insertAdjacentHTML("beforeend",i)})}evaluateEligibility(){const t=this.getEligibilityCriteria(this.participantData.participantType);let e=0,i=0;const a={};t.forEach(t=>{const n=document.querySelector(`input[name="criteria_${t.id}"]:checked`)?.value,r=document.getElementById(`comment_${t.id}`).value;a[t.id]={value:n,comment:r,text:t.text,required:t.required},t.required&&(i++,"yes"===n&&e++);const s=document.getElementById(`criteria_${t.id}`);s.classList.remove("valid","invalid"),"yes"===n?s.classList.add("valid"):"no"===n&&s.classList.add("invalid")}),this.participantData.eligibilityChecklist={criteriaResults:a,eligibilityStatus:e===i?"eligible":"not-eligible",eligibilityReason:`Met ${e} of ${i} required criteria`,assessedBy:JSON.parse(localStorage.getItem("researchAssistantDetails")||"{}").initials||"Unknown",assessmentDate:(new Date).toISOString()}}generateReviewSummary(){const t=document.getElementById("reviewSummary"),e=this.participantData,i="eligible"===e.eligibilityChecklist.eligibilityStatus?"success":"danger",a="eligible"===e.eligibilityChecklist.eligibilityStatus?"check-circle":"x-circle";t.innerHTML=`\n          <div class="row">\n            <div class="col-md-6">\n              <h6><i class="bi bi-person me-2"></i>Participant Information</h6>\n              <table class="table table-sm">\n                <tr><td><strong>Type:</strong></td><td>${e.participantType}</td></tr>\n                <tr><td><strong>Participant ID:</strong></td><td>${e.participantId||"[Will be generated]"}</td></tr>\n                <tr><td><strong>RA Initials:</strong></td><td>${e.raInitials||"[Will be generated]"}</td></tr>\n                <tr><td><strong>Age Range:</strong></td><td>${e.basicInfo.ageRange}</td></tr>\n                <tr><td><strong>Gender:</strong></td><td>${e.basicInfo.gender}</td></tr>\n                <tr><td><strong>District:</strong></td><td>${e.basicInfo.district||"Not specified"}</td></tr>\n                <tr><td><strong>Hospital:</strong></td><td>${e.basicInfo.hospital||"Not specified"}</td></tr>\n              </table>\n            </div>\n            <div class="col-md-6">\n              <h6><i class="bi bi-clipboard-check me-2"></i>Eligibility Status</h6>\n              <div class="alert alert-${i} mb-3">\n                <i class="bi bi-${a} me-2"></i>\n                <strong>${e.eligibilityChecklist.eligibilityStatus.toUpperCase()}</strong><br>\n                ${e.eligibilityChecklist.eligibilityReason}\n              </div>\n              <small class="text-muted">\n                Assessed by: ${e.eligibilityChecklist.assessedBy}<br>\n                Date: ${new Date(e.eligibilityChecklist.assessmentDate).toLocaleDateString()}\n              </small>\n            </div>\n          </div>\n        `}saveParticipant(){try{const t=this.dataManager.addParticipant(this.participantData),e="eligible"===this.participantData.eligibilityChecklist.eligibilityStatus?"success":"warning",i="eligible"===this.participantData.eligibilityChecklist.eligibilityStatus?`Participant ${t} has been saved and is eligible for the study!`:`Participant ${t} has been saved but is not eligible for the study.`;this.showAlert(i,e),setTimeout(()=>{this.resetWizard(),this.showParticipantList(),this.loadParticipants()},2e3)}catch(t){this.showAlert("Error saving participant. Please try again.","danger"),console.error("Save error:",t)}}showAlert(t,e){const i=`\n          <div class="alert alert-${e} alert-dismissible fade show" role="alert">\n            <i class="bi bi-check-circle me-2"></i>${t}\n            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>\n          </div>\n        `;document.querySelector(".main-content .container-fluid").insertAdjacentHTML("afterbegin",i)}resetWizard(){this.currentStep=1,this.participantData={},this.showStep(1),document.querySelectorAll("input, select, textarea").forEach(t=>{"radio"===t.type||"checkbox"===t.type?t.checked=!1:t.value=""}),document.querySelectorAll(".participant-type-card").forEach(t=>{t.classList.remove("border-primary","bg-light")})}loadParticipants(){const t=JSON.parse(localStorage.getItem("qualidata_participants")||"[]"),e=document.getElementById("participantsList"),i=document.getElementById("filterType").value,a=document.getElementById("filterStatus").value;let n=t;i&&(n=n.filter(t=>t.participantType===i)),a&&("eligible"===a?n=n.filter(t=>"eligible"===t.eligibilityChecklist?.eligibilityStatus):"not-eligible"===a&&(n=n.filter(t=>"not-eligible"===t.eligibilityChecklist?.eligibilityStatus)));const r={Patient:"Patients",Clinician:"Clinicians",Herbalist:"Herbalists","Policy Stakeholder":"Policy Stakeholders",Caregiver:"Caregivers"};let s="";(i?[i]:["Patient","Clinician","Herbalist","Policy Stakeholder","Caregiver"]).forEach(t=>{const e=n.filter(e=>e.participantType===t);s+=`<h5 class="mt-4 mb-2">Participant ID Tracker â€“ ${r[t]}</h5>\n            <table class="table table-bordered table-sm">\n              <thead>\n                <tr>\n                  <th>Participant ID</th>\n                  <th>Date of Contact</th>\n                  <th>Date Enrolled</th>\n                  <th>RA</th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                ${0===e.length?`<tr><td colspan="5" class="text-muted">No ${r[t].toLowerCase()} yet</td></tr>`:e.map(t=>`\n                  <tr>\n                    <td>${t.participantId}</td>\n                    <td>${t.dateOfContact?new Date(t.dateOfContact).toLocaleDateString():""}</td>\n                    <td>${t.dateEnrolled?new Date(t.dateEnrolled).toLocaleDateString():"Not enrolled"}</td>\n                    <td>${t.raInitials||""}</td>\n                    <td>\n                      ${"eligible"===t.eligibilityChecklist?.eligibilityStatus?`\n                        <button class="btn btn-sm btn-success me-1" onclick="startInterview('${t.participantId}')" title="Start Interview">\n                          <i class="bi bi-mic"></i>\n                        </button>\n                      `:""}\n                      <button class="btn btn-sm btn-outline-danger" onclick="deleteParticipant('${t.participantId}')" title="Delete">\n                        <i class="bi bi-trash"></i>\n                      </button>\n                    </td>\n                  </tr>\n                `).join("")}\n              </tbody>\n            </table>`}),e.innerHTML=s}selectParticipantType(t){this.participantData.participantType=t,document.querySelectorAll(".participant-type-card").forEach(t=>{t.classList.remove("border-primary","bg-light")}),event.target.closest(".participant-type-card").classList.add("border-primary","bg-light"),setTimeout(()=>{this.showStep(2)},500)}showStep(t){if(document.querySelectorAll(".step").forEach((e,i)=>{e.classList.remove("active","completed"),i+1<t?e.classList.add("completed"):i+1===t&&e.classList.add("active")}),document.querySelectorAll(".wizard-step").forEach((e,i)=>{e.style.display=i+1===t?"block":"none"}),this.currentStep=t,2===t){const t=JSON.parse(localStorage.getItem("researchAssistantDetails")||"{}");document.getElementById("participantDistrict").value=t.district||"",document.getElementById("participantHospital").value=t.hospital||""}}getEligibilityCriteria(t){return{Patient:[{id:"age18",text:"Age 18 years or older",required:!0},{id:"hypertension",text:"Diagnosed with hypertension",required:!0},{id:"consent",text:"Able to provide informed consent",required:!0},{id:"communication",text:"Able to communicate in English or local language",required:!0}],Clinician:[{id:"qualification",text:"Licensed healthcare professional",required:!0},{id:"experience",text:"Experience treating hypertension patients",required:!0},{id:"consent",text:"Willing to participate in study",required:!0}],Herbalist:[{id:"practice",text:"Active traditional healing practice",required:!0},{id:"hypertension_herbs",text:"Experience with herbs for hypertension",required:!0},{id:"consent",text:"Willing to share knowledge",required:!0}],"Policy Stakeholder":[{id:"position",text:"Role in health policy or regulation",required:!0},{id:"knowledge",text:"Knowledge of traditional medicine policies",required:!0},{id:"consent",text:"Willing to discuss policy matters",required:!0}],Caregiver:[{id:"caring",text:"Currently caring for hypertension patient",required:!0},{id:"age18",text:"Age 18 years or older",required:!0},{id:"consent",text:"Able to provide informed consent",required:!0}]}[t]||[]}generateParticipantId(t){return`${{Patient:"PAT",Clinician:"CLI",Herbalist:"HER","Policy Stakeholder":"POL",Caregiver:"CAR"}[t]||"PAR"}${Date.now().toString().slice(-6)}${Math.random().toString(36).substr(2,2).toUpperCase()}`}getRAInitials(){return JSON.parse(localStorage.getItem("researchAssistantDetails")||"{}").initials||"RA"}}const wizard=new ScreeningWizard;function showScreeningWizard(){document.getElementById("screeningWizardContainer").classList.add("active"),document.getElementById("participantsListContainer").style.display="none",wizard.resetWizard()}function showParticipantList(){document.getElementById("screeningWizardContainer").classList.remove("active"),document.getElementById("participantsListContainer").style.display="block",wizard.loadParticipants()}function selectParticipantType(t){wizard.selectParticipantType(t)}function nextStep(){wizard.nextStep()}function previousStep(){wizard.previousStep()}function saveParticipant(){wizard.saveParticipant()}function startInterview(t){const e=JSON.parse(localStorage.getItem("qualidata_participants")||"[]"),i=e.findIndex(e=>e.participantId===t);if(-1!==i){const t=e[i];t.dateEnrolled||(t.dateEnrolled=(new Date).toISOString(),e[i]=t,localStorage.setItem("qualidata_participants",JSON.stringify(e))),localStorage.setItem("currentInterviewParticipant",JSON.stringify(t)),window.location.href="interview.html"}}function deleteParticipant(t){if(confirm(`Are you sure you want to delete participant ${t}?`)){let e=JSON.parse(localStorage.getItem("qualidata_participants")||"[]");e=e.filter(e=>e.participantId!==t),localStorage.setItem("qualidata_participants",JSON.stringify(e)),wizard.loadParticipants(),wizard.showAlert(`Participant ${t} has been deleted.`,"info")}}function exportParticipantsToCSV(){const t=JSON.parse(localStorage.getItem("qualidata_participants")||"[]");if(!t.length)return void alert("No participants to export.");const e=t.map(t=>[t.participantId,t.participantType,t.dateOfContact?new Date(t.dateOfContact).toLocaleDateString():"",t.dateEnrolled?new Date(t.dateEnrolled).toLocaleDateString():"",t.raInitials||"",t.basicInfo?.ageRange||"",t.basicInfo?.gender||"",t.basicInfo?.district||"",t.basicInfo?.hospital||"",t.eligibilityChecklist?.eligibilityStatus||""]);let i="";i+=["Participant ID","Type","Date of Contact","Date Enrolled","RA Initials","Age Range","Gender","District","Hospital","Eligibility Status"].join(",")+"\n",e.forEach(t=>{i+=t.map(t=>'"'+String(t).replace(/"/g,'""')+'"').join(",")+"\n"});const a=new Blob([i],{type:"text/csv"}),n=URL.createObjectURL(a),r=document.createElement("a");r.href=n,r.download="participants.csv",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}function filterHospitalsByDistrict(){const t=document.getElementById("participantDistrict").value,e=document.getElementById("participantHospital"),i={"Akwapim North":["Tetteh Quarshie Memorial Hospital","Centre for Plant Medicine Research (CPMR), Mampong-Akwapim","Other (specify in comments)"],"Lower Manya-Krobo":["St. Martin de Porres Catholic Hospital, Agomenya","Other (specify in comments)"],"Kwahu South":["Kwahu Government Hospital","Other (specify in comments)"],Suhum:["Suhum District Hospital","Other (specify in comments)"],"Birim Central":["Oda Government Hospital","Other (specify in comments)"],Other:["Other (specify in comments)"]};e.innerHTML='<option value="">Select hospital/facility</option>',i[t]&&i[t].forEach(t=>{e.innerHTML+=`<option value="${t}">${t}</option>`})}document.getElementById("filterType").addEventListener("change",function(){wizard.loadParticipants()}),document.getElementById("filterStatus").addEventListener("change",function(){wizard.loadParticipants()}),showParticipantList(),document.addEventListener("DOMContentLoaded",function(){var t=JSON.parse(localStorage.getItem("researchAssistantDetails")||"{}"),e=document.getElementById("metaInfo");e&&(t&&t.initials&&t.district&&t.hospital?e.innerHTML=`<span class='fw-semibold'>RA:</span> ${t.initials} &nbsp;|&nbsp; <span class='fw-semibold'>District:</span> ${t.district} &nbsp;|&nbsp; <span class='fw-semibold'>Hospital:</span> ${t.hospital}`:e.innerHTML="<span class='text-muted'>RA profile not set</span>")})</script></body></html>